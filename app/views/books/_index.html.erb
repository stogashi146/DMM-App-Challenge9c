<table class='table table-hover table-inverse table-hover'>
  <thead>
    <tr>
      <th></th>
      <th><%= sort_link(@q, :title, "Title") %></th>
      <th><%= sort_link(@q, :body, "Opinion") %></th>
      <th><%= sort_link(@q, :favorites_user_id, "いいね") %></th>
      <th><%= sort_link(@q, :post_comments_comment, "コメント") %></th>
      <th><%= sort_link(@q, :rate, "評価") %></th>
      <th><%= sort_link(@q, :view_counts_user_id, "閲覧数") %></th>
    </tr>
  </thead>
  <tbody>
    <% books.each do |book| %>
        <tr data-link="<%= book_path(book) %>">
          <td><%= link_to user_path(book.user) do %>
            <%= attachment_image_tag(book.user, :profile_image, :fill, 50, 50, fallback: "no-image-icon.jpg") %>
            <% end %>
          </td>
          <td><%= link_to book.title, book_path(book),class: "book_#{book.id}" %></td>
          <td><%= book.body %></td>
          <!--いいね-->
          <td id="favorite-btn_<%= book.id %>">
            <%= render "books/favorite",book:book %>
          </td>
          <!--コメント件数-->
         <td>
           <%= "#{book.post_comments.count}コメント"%>
         </td>
         <!--評価の星表示-->
         <td id="star-rate-<%= book.id %>"></td>
         <script>
           $("#star-rate-<%= book.id %>").raty({
             size: 20,
             starOff: "<%= asset_path("star-off.png") %>",
             starOn: "<%= asset_path("star-on.png") %>",
             readOnly: true,
             score: "<%= book.rate %>",
           });
         </script>


         <!--閲覧数-->
         <td>
           <%= "閲覧数:#{book.view_counts.count}" %>
         </td>
        </tr>
    <% end %>
  </tbody>
</table>

<script>
  $("tr[data-link]").click(function() {
  window.location = $(this).data("link")
})
</script>